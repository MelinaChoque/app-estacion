<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Morphyx - Panel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
	<link rel="stylesheet" type="text/css" href="views/static/css/styles.css">
	
</head>
<body>


		<header class="header-detalle">
			<a href="../app-estacion"><i class="fa-solid fa-arrow-left"><h5>App clima</h5></i></a>
			<div class="center"> <h5>Estaciones disponibles	</h5></div>
			
		</header>
		<main class="main-panel">

		
				<div id="content">
			 		<template id="tpl__card">
			 			<div class="stream__row__card">
			 				<a class="link letra-blanca" href="#">
			 				<div class="stream__row__container">
			 					<div id="chipid"></div>
				 				<div class="apodo">
				 					apodo
				 				</div>
				 				<i class="fa-solid fa-person icon-absolute-person"></i>
				 				<div class="ubicacion">
				 					ubicacion
				 				</div>

				 				<div class="icon-absolute-abajo flex ">
                        			<i class="fa-regular fa-eye icon"></i>
                        			<div class="visitas">
				 						visitas
				 					</div>
                    			</div>
				 				
				 				<div class="estado"></div>
			 				</div>
			 				</a>
			 			</div>
			 		</template>
			 		<div id="stream__listado">
			 		</div>
			 	</div>

		</main>
		<footer class="footer-landing letra-blanca">
			<p class="p-15">Autor Choque Melina.</p>
		</footer>

	<script type="text/javascript">

		loadEstaciones().then( data => {
	 		data.forEach( row  => {
	 			addEstacion(row);
	 		});
	 	})

	 	function addEstacion(data){
	 		
	 		const tpl = tpl__card.content;
	 		/*< clona la plantilla como un nodo completo*/
	 		const clon = tpl.cloneNode(true);

	 		/*< alteramos el contenido del clon con los valores de data */
	 		clon.querySelector(".apodo").textContent = data.apodo;
	 		clon.querySelector(".ubicacion").textContent = data.ubicacion;
	 		clon.querySelector(".visitas").textContent = data.visitas;
	 		clon.querySelector(".link").href = "detalle/"+data.chipid;

	 		if (data.dias_inactivo==0) {
	 			clon.querySelector(".estado").style.display = 'none';
	 		} else {
	 			clon.querySelector(".estado").innerHTML = 'Inactivo';
	 		}

			stream__listado.appendChild(clon);
	 	}

		async function loadEstaciones(){
		 	const response = await fetch("https://mattprofe.com.ar/proyectos/app-estacion/datos.php?mode=list-stations");
		 		const data = await response.json();
		 		return data;
		 		console.log(response)
		 	}
	</script>
	
</body>
</html>